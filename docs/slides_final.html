<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>AZS + Retail — MVP (Offline Slides)</title>
  <style>
    :root {
      --bg0:#0b1320; --bg1:#0e1626; --fg:#e8eef7; --accent:#1fd1d1; --muted:#9aa0a6;
    }
    html,body { height:100%; margin:0; background: radial-gradient(1200px 800px at 85% -10%, rgba(31,209,209,.18), transparent 60%), linear-gradient(180deg, var(--bg0), var(--bg1)); color:var(--fg); font-family: Inter, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, 'Helvetica Neue', Arial, sans-serif; }
    .deck { height:100%; width:100%; display:flex; align-items:center; justify-content:center; }
    .slide { position:absolute; inset:0; display:none; padding:64px; padding-top:160px; box-sizing:border-box; }
    #s1 { padding-top:120px; }
    .slide.active { display:block; }
    h1,h2,h3 { margin:0 0 16px 0; letter-spacing:.02em; }
    .pill { display:inline-block; padding:.25em .6em; border-radius:999px; background: var(--accent); color:#111; font-weight:700; }
    .kbd { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace; background:#111; color:var(--accent); padding:.2em .5em; border-radius:.35rem; }
    .two { display:grid; grid-template-columns: 1fr 1fr; gap:32px; }
    .card { background: rgba(255,255,255,.06); padding:18px 22px; border-radius:14px; }
    .brand { position: fixed; right: 24px; top: 18px; width: 180px; filter: drop-shadow(0 8px 24px rgba(0,0,0,.4)); }
    .footer { position: fixed; left:24px; bottom:16px; font-size:12px; color:#b7c0cc; opacity:.8; }
    .hint { position: fixed; right:24px; bottom:16px; font-size:12px; color:#b7c0cc; opacity:.8; }
    ul { line-height:1.5; }
  </style>
</head>
<body>
  <img class="brand" src="logo.png" alt="AZS + Retail" />
  <div class="deck">
    <section class="slide active" id="s1">
      <h1>AZS + Retail — MVP</h1>
      <p>Прогноз спроса · Запасы (SS/ROP) · API + UI</p>
      <p><span class="pill">5–7 минут</span> · <span class="pill">16:9</span></p>
      <p>Цель — уменьшить ошибки прогноза и связать метрики с деньгами. Покажу конвейер от данных до продакшена.</p>
    </section>

    <section class="slide" id="s2">
      <h2>Постановка задачи и KPI</h2>
      <ul>
        <li>Гранулярность: магазин × товар (per‑SKU)</li>
        <li>Метрики: MAE / MAPE / P50 / P90</li>
        <li>Сервис‑левел: покрытие квантилей</li>
        <li>Экономика: SS/ROP из квантилей</li>
      </ul>
    </section>

    <section class="slide" id="s3">
      <h2>Бизнес‑цель</h2>
      <div class="two">
        <div class="card">
          <h3>Снижаем <span class="pill">stockout</span></h3>
          <ul><li>P50 → базовый план закупок</li><li>P90 → страховой запас (SS)</li></ul>
        </div>
        <div class="card">
          <h3>Контролируем <span class="pill">overstock</span></h3>
          <ul><li>ROP = LT × P50 + SS(P90)</li><li>Баланс сервис‑левел / хранение</li></ul>
        </div>
      </div>
    </section>

    <section class="slide" id="s4">
      <h2>Данные</h2>
      <div class="two">
        <div>
          <ul>
            <li>Продажи (train)</li>
            <li>Транзакции</li>
            <li>Нефть (oil)</li>
            <li>Праздники</li>
            <li>Справочник магазинов</li>
          </ul>
        </div>
        <div class="card">
          <p>Parquet + DuckDB · ETL конвейер</p>
          <p class="kbd">make validate && make etl && make features</p>
          <p>Демо: Top‑20 пар по обороту</p>
        </div>
      </div>
    </section>

    <section class="slide" id="s4a">
      <h2>EDA и ключевые инсайты</h2>
      <div class="two">
        <div>
          <ul>
            <li>Сезонность по дням недели и месяцам</li>
            <li>Праздничные всплески спроса</li>
            <li>Влияние промо‑акций</li>
          </ul>
        </div>
        <div class="card" style="display:flex; flex-direction:column; gap:16px;">
          <img src="eda_seasonality_dow.png" alt="Сезонность по дням недели" style="width:100%; border-radius:12px;" />
          <img src="eda_seasonality_month.png" alt="Сезонность по месяцам" style="width:100%; border-radius:12px;" />
          <img src="eda_promo_effect.png" alt="Влияние промо" style="width:100%; border-radius:12px;" />
        </div>
      </div>
    </section>

    <section class="slide" id="s5">
      <h2>Feature Engineering</h2>
      <ul>
        <li>Лаги: 1 / 7 / 14 / 28</li>
        <li>Скользящие средние, дисперсии</li>
        <li>Акции, календарь, транзакции</li>
        <li>Экзогенные: нефть · базовая частота W‑FRI</li>
      </ul>
      <p class="kbd">make features</p>
    </section>

    <section class="slide" id="s6">
      <h2>Модели и валидация</h2>
      <div class="two">
        <div>
          <ul>
            <li>LightGBM per‑SKU (P50/P90)</li>
            <li>CatBoost / XGBoost / RandomForest</li>
            <li>LSTM — демо для ансамбля</li>
          </ul>
        </div>
        <div class="card">
          <p>Holdout 28 дней + опциональный TS‑CV</p>
          <p class="kbd">make train · make train_rf · make train_global · make train_lstm</p>
        </div>
      </div>
    </section>

    <section class="slide" id="s7">
      <h2>Результаты</h2>
      <ul>
        <li>Средний MAPE ~ <b>6.6%</b> (LGBM — лидер)</li>
        <li>RF хуже; LSTM пока уступает → в ансамбль</li>
        <li>Глобальные — быстрый старт / cold start</li>
      </ul>
      <p class="kbd">data_dw/summary_metrics.txt · docs/model_comparison.csv</p>
    </section>

    <section class="slide" id="s8">
      <h2>Business Impact</h2>
      <div class="two">
        <div class="card">
          <p>Переводим MAPE → деньги: маржа и хранение</p>
          <p class="kbd">make impact</p>
        </div>
        <div>
          <p class="kbd">data_dw/business_impact_report.csv</p>
          <p>−1–2% MAPE даёт ощутимую экономию · SS/ROP из P50/P90</p>
        </div>
      </div>
    </section>

    <section class="slide" id="s9">
      <h2>Демо — FastAPI</h2>
      <ul>
        <li>http://localhost:8000/docs</li>
        <li>POST /predict_demand → точка + квантиль</li>
        <li>GET /health · Prometheus: /metrics-prom</li>
      </ul>
      <pre>{{ "store_nbr": 1, "family": "BEVERAGES", "horizon_weeks": 4 }}</pre>
    </section>

    <section class="slide" id="s10">
      <h2>Демо — Streamlit UI</h2>
      <ul>
        <li>http://localhost:8501</li>
        <li>Сравнение моделей: LGBM vs RF vs XGB vs LSTM</li>
        <li>Теплокарта MAE/MAPE, экспорт CSV</li>
        <li>Бизнес‑метрики: SS/ROP по SKU</li>
      </ul>
      <p class="kbd">make api · make ui</p>
    </section>

    <section class="slide" id="s11">
      <h2>Прод / Docker / Troubleshooting</h2>
      <ul>
        <li>Makefile таргеты на весь пайплайн</li>
        <li><span class="kbd">make demo-full</span> — полный сценарий</li>
        <li><span class="kbd">docker compose up --build</span></li>
        <li>Экспорт в ONNX + INT8 квантизация</li>
      </ul>
    </section>

    <section class="slide" id="s12">
      <h2>Ограничения и планы</h2>
      <ul>
        <li>Шумные данные, нестабильные SKU</li>
        <li>Ансамбль LGBM + LSTM</li>
        <li>Новые экзогенные факторы</li>
        <li>Мониторинг дрейфа</li>
        <li>Классификатор out‑of‑stock</li>
      </ul>
    </section>

    <section class="slide" id="s13">
      <h2>Спасибо!</h2>
      <p>Код — GitHub · Демо — <span class="kbd">make demo</span> · Презентация — slides_final.html</p>
      <p>AZS + Retail MVP · 2025</p>
    </section>
  </div>

  <div class="footer">Навигация: ← → или PgUp/PgDn · F — полный экран</div>
  <div class="hint" id="hint"></div>

  <script>
    (function () {
      var slides = Array.prototype.slice.call(document.querySelectorAll('.slide'));
      var idx = 0;
      var nextKeys = ['ArrowRight', 'PageDown', ' '];
      var prevKeys = ['ArrowLeft', 'PageUp', 'Backspace'];

      function setActive(i) {
        if (!slides.length) {
          return;
        }
        idx = (i + slides.length) % slides.length;
        for (var k = 0; k < slides.length; k++) {
          if (k === idx) {
            slides[k].classList.add('active');
          } else {
            slides[k].classList.remove('active');
          }
        }
        var hint = document.getElementById('hint');
        if (hint) {
          hint.textContent = (idx + 1) + ' / ' + slides.length;
        }
      }

      function tryFullscreen() {
        var root = document.documentElement;
        if (root.requestFullscreen) {
          root.requestFullscreen();
        } else if (root.webkitRequestFullscreen) {
          root.webkitRequestFullscreen();
        } else if (root.mozRequestFullScreen) {
          root.mozRequestFullScreen();
        } else if (root.msRequestFullscreen) {
          root.msRequestFullscreen();
        }
      }

      function handleKey(event) {
        var key = event.key || '';
        if (nextKeys.indexOf(key) !== -1) {
          setActive(idx + 1);
          return;
        }
        if (prevKeys.indexOf(key) !== -1) {
          setActive(idx - 1);
          return;
        }
        if (key === 'f' || key === 'F') {
          tryFullscreen();
          return;
        }
        if (!key && typeof event.keyCode === 'number') {
          var code = event.keyCode;
          if (code === 39 || code === 34 || code === 32) {
            setActive(idx + 1);
          } else if (code === 37 || code === 33 || code === 8) {
            setActive(idx - 1);
          } else if (code === 70) {
            tryFullscreen();
          }
        }
      }

      document.addEventListener('keydown', handleKey, false);
      setActive(0);
    })();
  </script>
</body>
</html>
